#!/bin/sh

for bat in /sys/class/power_supply/BAT?*; do
	[ -n "${cap+x}" ] && printf " "
	cap="$(cat "$bat/capacity" 2>&1)"
	stat="$(cat "$bat/status" 2>&1)"
	case "$stat" in
		Full) flag="F" ;;
		Charging) flag="C" ;;
		Discharging) [ "$cap" -le 10 ] && flag="!" ;;
		"Not charging") flag="N" ;;
		Unknown) flag="?" ;;
	esac
	printf "%d%%%s" "$cap" "${flag:+ [$flag]}"
done && echo
