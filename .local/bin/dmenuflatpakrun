#!/bin/sh

command -v flatpak >/dev/null 2>&1 ||
	(notify-send -a "$(basename "$0")" "error" "flatpak is not installed"; exit 1)

apps="$(flatpak list --app --columns=application,name | tail -n +1 | tr "\t" " ")"
if [ -z "$apps" ]; then
	notify-send -a "$(basename "$0")" "error" "no installed apps"
	exit 1
fi

sel="$(echo "$apps" | cut -d " " -f 2- | dmenu -i -p "flatpak run:")" || exit 1
id="$(echo "$apps" | awk "/$sel/{print \$1}")"
[ -z "$id" ] && exit 1

exec flatpak run "$id"
