#!/usr/bin/env python3

import pathlib
import json
import lz4.block

files = (
    pathlib.Path.home()
    .joinpath(".mozilla/firefox")
    .glob("*default*/sessionstore-backups/recovery.js*")
)
for f in files:
    b = f.read_bytes()
    if b[:8] == b"mozLz40\0":
        b = lz4.block.decompress(b[8:])
    j = json.loads(b)
    for w in j["windows"]:
        for t in w["tabs"]:
            e = t["entries"][t["index"] - 1]
            print(f"{e['title']} ({e['url']})")
