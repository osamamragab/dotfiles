#!/bin/sh
# passmenu replacement for Wayland
# requires pass, wl-copy (wl-clipboard), notify-send (libnotify), and menu script

app="$(basename "$0")"
dir="${PASSWORD_STORE_DIR-$HOME/.password-store}"
sel="$(find "$dir" -type f -name "*.gpg" -printf "%P\n" | sed -e 's/\.gpg$//' | menu -p "$app> ")" || exit 1
pass -c "$sel" || { notify-send -a "$app" -u critical error "pass command failed"; exit 1; }
notify-send -a "$app" "$sel" "password copied to clipboard"
