#!/bin/sh

usage() {
	echo "usage: $(basename "$0") [-m maxdepth] [-t type] <name>" >&2
	exit 1
}

maxdepth=0
type=""
name=""

while [ $# -gt 0 ]; do
	case "$1" in
		-m)
			case "$2" in
				""|*[!0-9]*) usage ;;
				*) maxdepth="$2" ;;
			esac
			shift
			;;
		-t)
			case "$2" in
				[bcdpflsD]) [ "$type" ] && type="$type,$2" || type="$2" ;;
				*) usage ;;
			esac
			shift
			;;
		*) name="$1" ;;
	esac
	shift
done

args="."
[ "$maxdepth" -ne 0 ] && args="$args -maxdepth $maxdepth"
[ "$type" ] && args="$args -type $type"
[ "$name" ] && args="$args -iname '*$name*'"
args="$args -printf '%P\n'"

printf "%s" "$args" | xargs find
